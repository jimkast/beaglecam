"use strict";var ApplicationConfiguration=function(){var a="cam-project",b=["ngResource","ngCookies","ngAnimate","ngTouch","ngSanitize","ui.router","ui.bootstrap","ui.utils"],c=function(b){return angular.module(b,[]),angular.module(a).requires.push(b),angular.module(b)};return{applicationModuleName:a,applicationModuleVendorDependencies:b,registerModule:c}}();angular.module(ApplicationConfiguration.applicationModuleName,ApplicationConfiguration.applicationModuleVendorDependencies),angular.module(ApplicationConfiguration.applicationModuleName).config(["$locationProvider",function(a){a.hashPrefix("!")}]),angular.element(document).ready(function(){"#_=_"===window.location.hash&&(window.location.hash="#!"),angular.bootstrap(document,[ApplicationConfiguration.applicationModuleName])}),ApplicationConfiguration.registerModule("answers").config(["$stateProvider",function(a){a.state("listAnswers",{url:"/answers",templateUrl:"modules/answers/list-answers.client.view.html"}).state("createAnswer",{url:"/answers/create",templateUrl:"modules/answers/create-answer.client.view.html"}).state("viewAnswer",{url:"/answers/:id",templateUrl:"modules/answers/view-answer.client.view.html"}).state("editAnswer",{url:"/answers/:id/edit",templateUrl:"modules/answers/edit-answer.client.view.html"})}]).run(["Menus",function(a){a.addMenuItem("topbar","Answers","answers"),a.addMenuItem("topbar","New Answer","answers/create")}]).factory("Answers",["baseCRUD","YouTube","$sce",function(a,b,c){var d=new a("answers");return d.callbacks.findOne.after=function(a){a.videoDetails={embed:c.trustAsResourceUrl(b.embedUrlFromID(b.videoIdFromUrl(a.video)))}},d}]).controller("AnswersController",["$scope","Authentication","Answers","Questions","Grades",function(a,b,c,d,e){a.authentication=b,a.Questions=d.init(),a.question=d.single,a.questions=d.list,a.Answers=c.init(),a.answer=c.single,a.answers=c.list,a.Grades=e.init(),a.grade=e.single,a.grades=e.list,e.callbacks.update.success=function(){},e.callbacks.create.success=function(){},a.findWithGrade=function(){c.findOne(null,function(c){e.find({answer:c._id,user:b.user._id},function(b){b instanceof Array&&b.length?angular.extend(a.grade,b[0]):angular.extend(a.grade,{answer:c._id})})})}}]),ApplicationConfiguration.registerModule("articles"),ApplicationConfiguration.registerModule("core").filter("groupBy",["$parse",function(a){return function(b,c){var d=[],e=null,f=!1,g="group_by_CHANGED";return angular.forEach(b,function(b){if(f=!1,null!==e){c=angular.isArray(c)?c:[c];for(var h=0,i=c.length;i>h;h++)a(c[h])(e)!==a(c[h])(b)&&(f=!0)}else f=!0;b[g]=f?!0:!1,d.push(b),e=b}),d}}]),ApplicationConfiguration.registerModule("crud").factory("baseCRUD",["$resource","$stateParams","$location",function(a,b,c){var d=function(d){var e=this;e.init=function(){return e.list=[],e.single={},e.error,e};var f=function(b){return a(b,{pathId:"@_id"},{update:{method:"PUT"}})},g=f(d+"/:pathId"),h={create:{before:function(){},after:function(){},success:function(a){angular.copy({},e.single),c.path(d+"/"+a._id)},error:function(a){e.error=a.data.message}},remove:{before:function(){},after:function(){},success:function(){c.path(d)},error:function(a){e.error=a.data.message}},update:{before:function(){},after:function(){},success:function(a){c.path(d+"/"+a._id)},error:function(a){e.error=a.data.message}},find:{before:function(){},after:function(){},success:function(){},error:function(){}},findOne:{before:function(){},after:function(){},success:function(){},error:function(){}}};e.callbacks=h,e.create=function(a,b){var c=new g(e.single),a=a||h.create.success,b=b||h.create.error;return c.$save(a,b),c},e.remove=function(a,b,c){var b=b||h.remove.success,c=c||h.remove.error;if(a)a.$remove(function(){for(var a in e.list)e.list[a]===object&&e.list.splice(a,1)},c);else{var d=new g(e.single);d.$remove(b,c)}},e.update=function(a,b,c){var b=b||h.update.success,c=c||h.update.error,d=new g(e.single);d.$update(b,c)},e.find=function(a,b,c){var b=b||h.findOne.success,c=c||h.findOne.error;h.find.before(a),g.query(a,function(a){angular.extend(e.list,a),h.find.after(a),b(a)},c)},e.query=e.find,e.findOne=function(a,c,d){var a=a||b.id,c=c||h.findOne.success,d=d||h.findOne.error;h.findOne.before(a),a&&g.get({pathId:a},function(a){angular.extend(e.single,a),h.findOne.after(e.single),c(a)},d)},e.urls={create:function(){return"/#!/"+d+"/create"},list:function(){return"/#!/"+d},view:function(a){var a=a||b.id;return"/#!/"+d+"/"+a},edit:function(a){var a=a||b.id;return"/#!/"+d+"/"+a+"/edit"}}};return d}]),ApplicationConfiguration.registerModule("grades").factory("Grades",["baseCRUD","YouTube","$sce",function(a){return new a("grades")}]),ApplicationConfiguration.registerModule("questions").config(["$stateProvider",function(a){a.state("listQuestions",{url:"/questions",templateUrl:"modules/questions/list-questions.client.view.html"}).state("createQuestion",{url:"/questions/create",templateUrl:"modules/questions/create-question.client.view.html"}).state("viewQuestion",{url:"/questions/:id",templateUrl:"modules/questions/view-question.client.view.html"}).state("editQuestion",{url:"/questions/:id/edit",templateUrl:"modules/questions/edit-question.client.view.html"})}]).run(["Menus",function(a){a.addMenuItem("topbar","Questions","questions"),a.addMenuItem("topbar","New Question","questions/create")}]).factory("Questions",["baseCRUD",function(a){return new a("questions")}]).controller("QuestionsController",["$scope","Authentication","Questions",function(a,b,c){a.authentication=b,a.Questions=c.init(),a.question=c.single,a.questions=c.list}]),ApplicationConfiguration.registerModule("student"),ApplicationConfiguration.registerModule("teacher").config(["$stateProvider",function(a){a.state("teacher1",{url:"/teachers/step1",templateUrl:"modules/teacher/teacher-step-1.client.view.html"}).state("teacher2",{url:"/teachers/step2",templateUrl:"modules/teacher/teacher-step-2.client.view.html"})}]).run(["Menus",function(a){a.addMenuItem("topbar","Teachers","teachers/step1",null,null,["teacher"]),a.addMenuItem("topbar","Teachers Step 2","teachers/step2",null,null,["teacher"])}]).controller("TeacherController",["$scope","$sce","$stateParams","$location","Authentication","Grades","Answers","Questions",function(a,b,c,d,e,f,g,h){a.authentication=e,a.yt=new youtube,a.Questions=h.init(),a.question=h.single,a.questions=h.list,a.Answers=g.init(),a.answer=g.single,a.answers=g.list,a.fetchAnswers=function(){a.answers=g.query()}}]),ApplicationConfiguration.registerModule("users"),ApplicationConfiguration.registerModule("youtube").factory("YouTube",[function(){return new youtube}]);var youtube=function(){var a=this;a.videoIdFromUrl=function(a){var b=a.match(/(?:https?:\/{2})?(?:w{3}\.)?youtu(?:be)?\.(?:com|be)(?:\/watch\?v=|\/)([^\s&]+)/);return b?b[1]:!1},a.embedUrlFromID=function(a){return"http://www.youtube.com/embed/"+a},a.getThumbnails=function(a){for(var b=[],c="http://img.youtube.com/vi/",d=".jpg",e=0;4>e;e++)b.push(c+a+"/"+e+d);return b},a.getVideoDetails=function(a,b,c){$http({method:"GET",url:"http://gdata.youtube.com/feeds/api/videos/"+a,param:{alt:"json"}}).success(b).error(c)},a.getVideoTitle=function(b,c){a.getVideoDetails(b,function(a){return a?void c(a.entry.title.media$title.$t):!1})}};angular.module("articles").run(["Menus",function(){}]),angular.module("articles").config(["$stateProvider",function(a){a.state("listArticles",{url:"/articles",templateUrl:"modules/articles/views/list-articles.client.view.html"}).state("createArticle",{url:"/articles/create",templateUrl:"modules/articles/views/create-article.client.view.html"}).state("viewArticle",{url:"/articles/:articleId",templateUrl:"modules/articles/views/view-article.client.view.html"}).state("editArticle",{url:"/articles/:articleId/edit",templateUrl:"modules/articles/views/edit-article.client.view.html"})}]),angular.module("articles").factory("Articles",["$resource",function(a){return a("articles/:articleId",{articleId:"@_id"},{update:{method:"PUT"}})}]),angular.module("articles").controller("ArticlesController",["$scope","$stateParams","$location","Authentication","Articles",function(a,b,c,d,e){a.authentication=d,a.create=function(){var b=new e({title:this.title,content:this.content});b.$save(function(a){c.path("articles/"+a._id)},function(b){a.error=b.data.message}),this.title="",this.content=""},a.remove=function(b){if(b){b.$remove();for(var d in a.articles)a.articles[d]===b&&a.articles.splice(d,1)}else a.article.$remove(function(){c.path("articles")})},a.update=function(){var b=a.article;b.$update(function(){c.path("articles/"+b._id)},function(b){a.error=b.data.message})},a.find=function(){a.articles=e.query()},a.findOne=function(){a.article=e.get({articleId:b.articleId})}}]),angular.module("core").controller("HeaderController",["$scope","Authentication","Menus",function(a,b,c){a.authentication=b,a.isCollapsed=!1,a.menu=c.getMenu("topbar"),a.toggleCollapsibleMenu=function(){a.isCollapsed=!a.isCollapsed}}]),angular.module("core").controller("HomeController",["$scope","Authentication",function(a,b){a.authentication=b}]),angular.module("core").factory("baseCRUD",["$resource","$stateParams","$location",function(a,b,c){var d=function(d,e,f){var g=this;g.list=f||[],g.single=e||{},g.error;var h=function(b){return a(b,{pathId:"@_id"},{update:{method:"PUT"}})},i=h(d+"/:pathId"),j={create:{success:function(a){angular.copy({},g.single),c.path(d+"/"+a._id)},error:function(a){g.error=a.data.message}},remove:{success:function(){c.path(d)},error:function(a){g.error=a.data.message}},update:{success:function(){c.path(d)+"/"+b.id},error:function(a){g.error=a.data.message}}};g.create=function(a,b){console.log(g.single);var c=new i(g.single),a=a||j.create.success,b=b||j.create.error;return c.$save(a,b),c},g.remove=function(a,b,c){var b=b||j.remove.success,c=c||j.remove.error;if(a)a.$remove(function(){for(var a in g.list)g.list[a]===object&&g.list.splice(a,1)},c);else{var d=new i(g.single);d.$remove(b,c)}},g.update=function(a,b,c){var b=b||j.update.success,c=c||j.update.error,d=new i(g.single);d.$update(b,c)},g.find=function(a){i.query(a,function(a){angular.extend(g.list,a)})},g.findOne=function(a){var a=a||b.id;a&&i.get({pathId:a},function(a){angular.extend(g.single,a)})},g.urls={create:function(){return"/#!/"+d+"/create"},list:function(){return"/#!/"+d},view:function(a){var a=a||b.id;return"/#!/"+d+"/"+a},edit:function(a){var a=a||b.id;return"/#!/"+d+"/"+a+"/edit"}}};return d}]),angular.module("core").service("Menus",[function(){this.defaultRoles=["user"],this.menus={};var a=function(a){if(!a)return this.isPublic;for(var b in a.roles)for(var c in this.roles)if(this.roles[c]===a.roles[b])return!0;return!1};this.validateMenuExistance=function(a){if(a&&a.length){if(this.menus[a])return!0;throw new Error("Menu does not exists")}throw new Error("MenuId was not provided")},this.getMenu=function(a){return this.validateMenuExistance(a),this.menus[a]},this.addMenu=function(b,c,d){return this.menus[b]={isPublic:c||!1,roles:d||this.defaultRoles,items:[],shouldRender:a},this.menus[b]},this.removeMenu=function(a){this.validateMenuExistance(a),delete this.menus[a]},this.addMenuItem=function(b,c,d,e,f,g){return this.validateMenuExistance(b),this.menus[b].items.push({title:c,link:d,uiRoute:e||"/"+d,isPublic:f||this.menus[b].isPublic,roles:g||this.defaultRoles,shouldRender:a}),this.menus[b]},this.removeMenuItem=function(a,b){this.validateMenuExistance(a);for(var c in this.menus[a].items)this.menus[a].items[c].link===b&&this.menus[a].items.splice(c,1);return this.menus[a]},this.addMenu("topbar")}]),angular.module("core").config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/"),a.state("home",{url:"/",templateUrl:"modules/core/views/home.client.view.html"})}]),angular.module("grades").run(["Menus",function(a){a.addMenuItem("topbar","Grades","grades"),a.addMenuItem("topbar","New Grade","grades/create")}]),angular.module("grades").config(["$stateProvider",function(a){a.state("listGrades",{url:"/grades",templateUrl:"modules/grades/views/list-grades.client.view.html"}).state("createGrade",{url:"/grades/create",templateUrl:"modules/grades/views/create-grade.client.view.html"}).state("viewGrade",{url:"/grades/:gradeId",templateUrl:"modules/grades/views/view-grade.client.view.html"}).state("editGrade",{url:"/grades/:gradeId/edit",templateUrl:"modules/grades/views/edit-grade.client.view.html"})}]),angular.module("grades").controller("GradesController",["$scope","$sce","$stateParams","$location","Authentication","Grades","Questions","Answers",function(a,b,c,d,e,f,g,h){a.authentication=e,a.create=function(){var b=new f(a.grade);b.$save(function(a){d.path("grades/"+a._id)},function(b){a.error=b.data.message}),angular.copy({},a.grade)},a.remove=function(b){if(b){b.$remove();for(var c in a.grades)a.grades[c]===b&&a.grades.splice(c,1)}else a.grade.$remove(function(){d.path("grades")})},a.update=function(){var b=a.grade;b.$update(function(){d.path("grades/"+b._id)},function(b){a.error=b.data.message})},a.find=function(){a.grades=f.query()},a.findOne=function(){a.grade=f.get({gradeId:c.gradeId},function(){a.grade.answer.video2=b.trustAsResourceUrl(a.grade.answer.video.replace("watch?v=","embed/"))})},a.findByAnswer=function(d){{var d=d||c.answerId;f.query({answer:d},function(c){c.length?(a.grade=c[0],a.grade.answer.video2=b.trustAsResourceUrl(a.grade.answer.video.replace("watch?v=","embed/"))):a.grade={answer:d}})}},a.grade={},a.fetchQuestions=function(){a.questions=g.query(function(){a.question=a.grade.answer&&a.grade.answer.question||a.questions[0]._id})},a.$watch("question",function(b){b&&a.fetchAnswers(b)}),a.fetchAnswers=function(){a.answers=h.query({question:a.question},function(){a.answers.length&&(a.grade.answer=a.grade.answer&&a.grade.answer._id||a.answers[0]._id)})}}]),angular.module("grades").factory("GradesOLD",["$resource",function(a){return a("grades/:gradeId",{gradeId:"@_id"},{update:{method:"PUT"}})}]),angular.module("student").run(["Menus",function(a){a.addMenuItem("topbar","Students","students/step1",null,null,["student"]),a.addMenuItem("topbar","Students Step 2","students/step2",null,null,["student"])}]),angular.module("student").config(["$stateProvider",function(a){a.state("student1",{url:"/students/step1",templateUrl:"modules/student/views/student-step-1.client.view.html"}).state("student2",{url:"/students/step2",templateUrl:"modules/student/views/student-step-2.client.view.html"})}]),angular.module("student").controller("StudentController",["$scope","$sce","$stateParams","$location","Authentication","Grades","Answers","Questions",function(a,b,c,d,e,f,g,h){a.authentication=e,a.yt=new youtube,a.fetchAnswers=function(){a.answers=g.query()},a.findOne=function(){a.answer=g.get({answerId:c.answerId},function(){a.answer.video2=b.trustAsResourceUrl(a.answer.video.replace("watch?v=","embed/"))})},a.answer={},a.fetchQuestions=function(){a.questions=h.query()}}]),angular.module("users").controller("AuthenticationController",["$scope","$http","$location","Authentication",function(a,b,c,d){a.authentication=d,a.authentication.user&&c.path("/"),a.signup=function(){b.post("/auth/signup",a.credentials).success(function(b){a.authentication.user=b,c.path("/")}).error(function(b){a.error=b.message})},a.signin=function(){b.post("/auth/signin",a.credentials).success(function(b){a.authentication.user=b,c.path("/")}).error(function(b){a.error=b.message})}}]),angular.module("users").controller("SettingsController",["$scope","$http","$location","Users","Authentication",function(a,b,c,d,e){a.user=e.user,a.user||c.path("/"),a.hasConnectedAdditionalSocialAccounts=function(){for(var b in a.user.additionalProvidersData)return!0;return!1},a.isConnectedSocialAccount=function(b){return a.user.provider===b||a.user.additionalProvidersData&&a.user.additionalProvidersData[b]},a.removeUserSocialAccount=function(c){a.success=a.error=null,b.delete("/users/accounts",{params:{provider:c}}).success(function(b){a.success=!0,a.user=e.user=b}).error(function(b){a.error=b.message})},a.updateUserProfile=function(){a.success=a.error=null;var b=new d(a.user);b.$update(function(b){a.success=!0,e.user=b},function(b){a.error=b.data.message})},a.changeUserPassword=function(){a.success=a.error=null,b.post("/users/password",a.passwordDetails).success(function(){a.success=!0,a.passwordDetails=null}).error(function(b){a.error=b.message})}}]),angular.module("users").config(["$httpProvider",function(a){a.interceptors.push(["$q","$location","Authentication",function(a,b,c){return{responseError:function(d){switch(d.status){case 401:c.user=null,b.path("signin");break;case 403:}return a.reject(d)}}}])}]),angular.module("users").config(["$stateProvider",function(a){a.state("profile",{url:"/settings/profile",templateUrl:"modules/users/views/settings/edit-profile.client.view.html"}).state("password",{url:"/settings/password",templateUrl:"modules/users/views/settings/change-password.client.view.html"}).state("accounts",{url:"/settings/accounts",templateUrl:"modules/users/views/settings/social-accounts.client.view.html"}).state("signup",{url:"/signup",templateUrl:"modules/users/views/signup.client.view.html"}).state("signin",{url:"/signin",templateUrl:"modules/users/views/signin.client.view.html"})}]),angular.module("users").factory("Authentication",[function(){var a=this;return a._data={user:window.user},a._data}]),angular.module("users").factory("Users",["$resource",function(a){return a("users",{},{update:{method:"PUT"}})}]);
//# sourceMappingURL=application.min.js.map